image: kubeedge/edgemesh-agent:v1.10.0-23-gc4f8df4e-linux-amd64
armImage: kubeedge/edgemesh-agent:v1.10.0-23-gc4f8df4e-linux-arm64
nodeName: ""
affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
      - matchExpressions:
        - key: node-role.kubernetes.io/edge
          operator: Exists
        - key: kubernetes.io/arch
          operator: In
          values:
          - amd64
        - key: node-role.kubernetes.io/gateway
          operator: Exists
armAffinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
      - matchExpressions:
        - key: node-role.kubernetes.io/edge
          operator: Exists
        - key: kubernetes.io/arch
          operator: In
          values:
          - arm64
        - key: node-role.kubernetes.io/gateway
          operator: Exists
cloudAffinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
      - matchExpressions:
        - key: node-role.kubernetes.io/edge
          operator: DoesNotExist
        - key: kubernetes.io/arch
          operator: In
          values:
          - amd64
        - key: node-role.kubernetes.io/gateway
          operator: Exists
nodeSelector: {}
tolerations: {}
resources:
  limits:
    cpu: 1
    memory: 256Mi
  requests:
    cpu: 0.5
    memory: 128Mi

# edgemesh-gateway configmap
apiVersion: agent.edgemesh.config.kubeedge.io/v1alpha1
kind: EdgeMeshAgent
commonConfig:
  dummyDeviceName: edgemesh0
  dummyDeviceIP: 169.254.96.16
goChassisConfig:
  protocol:
    tcpBufferSize: 8192
    tcpClientTimeout: 5
    tcpReconnectTimes: 3
  loadBalancer:
    defaultLBStrategy: RoundRobin
    supportLBStrategies:
    - RoundRobin
    - Random
    - ConsistentHash
    consistentHash:
      partitionCount: 100
      replicationFactor: 10
      load: 1.25
modules:
  edgeDNS:
    enable: false
    listenPort: 53
    cacheDNS:
      enable: false
      autoDetect: true
      upstreamServers:
      cacheTTL: 30
  edgeGateway:
    enable: true
    nic: "*"
    includeIP: "*"
    excludeIP: "*"
  tunnel:
    enable: true
    listenPort: 20008
    security:
      enable: false
      httpServer: ""
      tlsCaFile: /etc/kubeedge/edgemesh/gateway/acls/rootCA.crt
      tlsCertFile: /etc/kubeedge/edgemesh/gateway/acls/server.crt
      tlsPrivateKeyFile: /etc/kubeedge/edgemesh/gateway/acls/server.key
    enableHolePunch: true
    transport: tcp
